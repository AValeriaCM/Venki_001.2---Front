<ion-header #header>
  <ion-toolbar #toolbar class="ion-toolbar-ccs">
    <div align="center">
      <ion-toolbar>
        <img src="/assets/FINAL-LOGO-MAGIN-PNG.png" width="170" height="100">
      </ion-toolbar>
    </div>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" [appHideHeader]="header" [scrollEvents]="true" slot="start" id="ion-content-opcional">
  <br>
  <div class="divBack">
    <div *ngIf="usertk !== null">
      <ion-grid class="profile-intro">
        <ion-row>
          <ion-col col-2>
            <img class="profile-photo" src="../../../assets/avatar/{{usertk.avatar}}.jpg" (click)="CreatePopover()">
          </ion-col>
          <ion-col col-10>
            <div class="profile-info">
              <div class="info-square">
                <p class="user-name"><strong>
                    <ion-label (click)="abrirDialogo(usertk)">{{usertk.name}} {{usertk.lastname}}</ion-label>
                  </strong></p>
              </div>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>


      <div class="more-details" *ngIf="usertk.description === null || usertk.description === ''">
        <p class="user-bio" (click)="abrirDialogo(usertk)">Puedes agregar tu descripcion.</p>
      </div>

      <div class="more-details" *ngIf="usertk.description !== null || usertk.description !== ''">
        <p class="user-bio" (click)="abrirDialogo(usertk)">{{usertk.description}}</p>
      </div>

      <mat-tab-group mat-stretch-tabs class="expand-css mat-elevation-z4" (selectedTabChange)="eventchangeTab($event)">

        <mat-tab>
          <ng-template mat-tab-label>
            <ion-icon name="grid" class="larger"></ion-icon>
          </ng-template>
          <br>
          <mat-tab-group mat-stretch-tabs class="expand-css2 mat-elevation-z4">
            <mat-tab>
              <ng-template mat-tab-label>
                <ion-card-title class="title-css2" style="text-align: center;">Mi Información</ion-card-title>
              </ng-template>
              <br>
              <!--form-edit-->
              <ion-card>
                <ion-card-content>
                  <div *ngIf="usertk">
                    <form [formGroup]="editarForm">
                      <ion-item>
                        <ion-icon name="person" style="color:  #002a68"></ion-icon>
                        <ion-input class="Subtitle-css" clearInput name="nombre" type="text"
                          placeholder="Ingresa Tu Nombre" formControlName="name">
                        </ion-input>
                      </ion-item>
                      <ion-item class='form-text-error'
                        *ngIf="!editarForm.controls.name.valid && (editarForm.controls.name.touched || editarForm.controls.name.dirty)">
                        <ion-label>El nombre Debe <br>tener minimo 5 Caracteres</ion-label>
                      </ion-item>
                      <br>
                      <ion-item>
                        <ion-icon name="person" style="color:  #002a68"></ion-icon>
                        <div>
                          <ion-input class="Subtitle-css" clearInput name="apellido" type="text"
                            placeholder="Ingresa Tu pellido" formControlName="lastname">
                          </ion-input>
                        </div>
                      </ion-item>
                      <ion-item class='form-text-error'
                        *ngIf="!editarForm.controls.lastname.valid && (editarForm.controls.lastname.touched || editarForm.controls.lastname.dirty)">
                        <ion-label>El Apellido Debe <br>tener minimo 5 Caracteres</ion-label>
                      </ion-item>
                      <br>
                      <ion-item class="Subtitle-css">
                        <ion-icon name="call" style="color: #002a68;"></ion-icon>
                        <ion-input name="celular" type="text" placeholder="Ingresa Tu #De Contacto" formControlName="phone">
                        </ion-input>
                      </ion-item>
                      <ion-item class='form-text-error'
                        *ngIf="!editarForm.controls.phone.valid && (editarForm.controls.phone.touched || editarForm.controls.phone.dirty)">
                        <ion-label>tu telefono Debe <br>tener minimo 8 Caracteres</ion-label>
                      </ion-item>
                      <br>
                      <ion-item>
                        <ion-icon name="calendar" style="color:  #002a68"></ion-icon>
                        <ion-datetime class="Subtitle-css" clearInput placeholder="Fecha de Nacimiento"
                          displayFormat="YYYY/MM/DD" min="1980" max="2005" formControlName="birthday"></ion-datetime>
                      </ion-item>
                      <br>
                      <ion-item *ngIf="usertk.description === null || usertk.description === ''">
                        <ion-icon name="chatbubble-ellipses" class="iconDesc" style="color:  #002a68"></ion-icon> &nbsp;
                        <ion-textarea formControlName="description" [disabled]="false" rows="5" class="Subtitle-cs-desc">Puedes agregar tu
                          descripcion.
                        </ion-textarea>
                      </ion-item>

                      <ion-item *ngIf="usertk.description !== null || usertk.description !== ''">
                        <ion-icon name="chatbubble-ellipses" style="color:  #002a68"></ion-icon> &nbsp;
                        <ion-textarea [disabled]="false" class="Subtitle-cs-desc" formControlName="description">
                        </ion-textarea>
                      </ion-item>
                      <br>
                      <ion-item *ngIf="usertk.institution === null || usertk.institution === ''">
                        <ion-icon name="school" class="iconDesc" style="color:  #002a68"></ion-icon> &nbsp;
                        <ion-input class="Subtitle-css" name="institution" type="text"
                          placeholder="Ingresa donde estudiaste" formControlName="institution">
                        </ion-input>
                      </ion-item>
                      <ion-item *ngIf="usertk.institution !== null">
                        <ion-icon name="school" class="iconDesc" style="color:  #002a68"></ion-icon> &nbsp;
                        <ion-input class="Subtitle-css" clearInput name="institution" type="text"
                          placeholder="Ingresa donde estudiaste" formControlName="institution">Donde Estudie: <br>
                        </ion-input>
                      </ion-item>
                      <ion-item class='form-text-error'
                        *ngIf="!editarForm.controls.institution.valid && (editarForm.controls.institution.touched || editarForm.controls.institution.dirty)">
                        <ion-label class="Subtitle-css">Ingresa Una Institución</ion-label>
                      </ion-item>
                      <br>
                      <ion-item *ngIf="usertk.status === null || usertk.status === ''">
                        <ion-icon name="heart-circle" style="color:  #002a68"></ion-icon> &nbsp;                        
                        <ion-select class="Subtitle-css" placeholder="Agrega tu Sitacion Sentimental"
                          (ionChange)="optionsFn(r.value);" #r>
                          <ion-select-option [value]="it" *ngFor="let it of items">{{it.situacion}}</ion-select-option>
                        </ion-select>
                      </ion-item>
                      <ion-item *ngIf="usertk.status !== null">
                        <ion-icon name="heart-circle" style="color:  #002a68"></ion-icon> &nbsp;                        
                        <ion-select class="Subtitle-css" placeholder="Agrega tu Sitacion Sentimental"
                          (ionChange)="optionsFn(r.value);" #r>
                          <ion-select-option [value]="it" *ngFor="let it of items">{{it.situacion}}</ion-select-option>
                        </ion-select>
                      </ion-item>
                      <br>
                      <ion-item *ngIf="usertk.city === null || usertk.city === ''">
                        <ion-icon name="location" style="color:  #002a68"></ion-icon> &nbsp;
                        <ion-input class="Subtitle-css" name="city" type="text" placeholder="Ingresa donde vives" formControlName="city">
                      </ion-input>
                      </ion-item>

                      <ion-item *ngIf="usertk.city !== null">
                        <ion-icon name="location" style="color:  #002a68"></ion-icon> &nbsp;
                        <!--<ion-label class="Subtitle-css">Donde Vives: <br> {{usertk.city}}</ion-label>-->
                        <ion-input class="Subtitle-css" formControlName="city">Donde Vives:</ion-input>
                      </ion-item>
                      <br>
                      <div padding>
                        <ion-button type="submit" (click)="editar()"
                          [disabled]="!editarForm.valid || situacionS === null" expand="block">Editar
                        </ion-button>
                      </div>
                    </form>
                  </div>
                </ion-card-content>
              </ion-card>
              <!--fin-form-->
              <!--<div *ngIf="usertk !== null">
                              
                <div align="center">
                  <ion-button class="button-css-options2" fill="clear" expand="block" (click)="abrirDialogo(usertk)">
                    <ion-icon name="create-outline"></ion-icon>&nbsp;
                    EDITAR INFORMACIÓN
                  </ion-button>
                </div>
              </div>-->
              <br>
            </mat-tab>
            <mat-tab>
              <ng-template mat-tab-label>
                <ion-card-title class="title-css2" style="text-align: center;">Mi Actividad</ion-card-title>
              </ng-template>
              <br>
              <ion-list class="itemCssFActividad list-mdActividad" *ngFor="let contenido of miactividad">
                <ion-card class="boder" [ngClass]="{
                  'boder-post-retar': contenido.post[0] == '#',
                  'boder-post-informar': contenido.post[0] == '!',
                  'boder-post-compartir': contenido.post[0] == '@'}">
                  <div>
                    <ion-item class="ion-item-css-">
                      <ion-avatar slot="start" class="imagestyle">
                        <img src="{{usertk.photo}}">
                      </ion-avatar>
                      <ion-label class="titlename">{{usertk.name}} {{usertk.lastname}}</ion-label>
                    </ion-item>
                    <br>
                    <div *ngIf="contenido.medias.length ===  0" class="labelContent">
                      <label>{{contenido.post}}</label>
                      <div class="time" class="ion-text-right"><br>
                        {{contenido.created_at | date:'short'}}
                      </div>
                    </div>
                    <br>
                    <div *ngIf="contenido.medias.length !==  0" class="labelContent">
                      <label>{{contenido.post}}</label>
                      <ion-slides [options]="sliderImgOption">
                        <ion-slide *ngFor="let imag of contenido.medias">
                          <img class="image-cont" src="https://venki.inkdigital.co/photos/{{imag.media}}">
                        </ion-slide>
                      </ion-slides>
                      <div class="time" class="ion-text-right"><br>
                        {{contenido.fecha | date:'short'}}
                      </div>
                    </div>
                  </div>
                </ion-card>
              </ion-list>
              <ion-infinite-scroll threshold="100px" position="bottom" (ionInfinite)="loadData($event)">
                <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Cargando post...">
                </ion-infinite-scroll-content>
              </ion-infinite-scroll>
            </mat-tab>
          </mat-tab-group>
        </mat-tab>


        <mat-tab>
          <ng-template mat-tab-label>
            <ion-icon name="bookmark" class="larger"></ion-icon>
          </ng-template>
          <br>

          <div>
            <div *ngIf="usertk.email !== null">

              <ion-card-title class="title-css" style="font-size: 20px; text-align: center;">MI DESARROLLO
              </ion-card-title>

              <mat-accordion>
                <mat-expansion-panel class="expacionCss">
                  <mat-expansion-panel-header class="expacionCss">
                    <mat-panel-title>
                      <label class="Subtitle-css-expansive">TROFEOS E INSIGNIAS</label>
                    </mat-panel-title>
                  </mat-expansion-panel-header>
                  <ion-row style="border-bottom: groove;">
                    <ion-col col-4>
                      <ion-label class="title-cssCursos">Trofeos</ion-label>
                    </ion-col>
                    <ion-col col-4>
                      <ion-label class="title-cssCursos">Insignias</ion-label>
                    </ion-col>
                  </ion-row>
                  <ion-row style="border-bottom: groove;" *ngFor="let tyi of trofeosInsig">
                    <ion-col col-4>
                      <ion-label class="title-cssCursos">{{tyi.trofeo}}</ion-label>
                    </ion-col>
                    <ion-col col-4>
                      <img style="margin-left: 24px;" src="{{tyi.insignia}}">
                    </ion-col>
                  </ion-row>

                </mat-expansion-panel>
              </mat-accordion>

              <ion-card-title class="title-css" style="font-size: 20px; text-align: center;">MIS CURSOS</ion-card-title>

              <mat-tab-group mat-stretch-tabs class="expand-css2 mat-elevation-z4">
                <mat-tab>
                  <ng-template mat-tab-label>
                    <ion-card-title class="title-css2" style="text-align: center;">CURSANDO</ion-card-title>
                  </ng-template>
                  <br>
                  <ion-list class="itemCssF list-md">
                    <div *ngFor="let curso of cursos">

                      <!--<ion-item class="ion-item-css">
                        <ion-avatar slot="start">
                          <img src="http://venki.3utilities.com/{{curso.photo}}" (click)="verCurso(curso)">
                        </ion-avatar>
                        <ion-label class="Subtitle-css" (click)="verCurso(curso)">{{curso.name}}</ion-label>
                        <div class="progress-course">
                          <ion-list-header>
                            <ion-label>Tu progreso: </ion-label>
                          </ion-list-header>
                          <ion-progress-bar value="0.5">{{curso.pivot.progress}}</ion-progress-bar>
                        </div>
                      </ion-item>
                      -->
                      <div *ngIf="curso.pivot.progress != 1">
                        <ion-item class="ion-item-css">
                          <ion-avatar slot="start">
                            <img src="https://venki.inkdigital.co/{{curso.photo}}" (click)="verCurso(curso)">
                          </ion-avatar>
                          <ion-label class="Subtitle-css" (click)="verCurso(curso)">
                            <h4>{{curso.name}}</h4>
                          </ion-label>
                          <div>
                            <ion-list-header>
                              <h5 style="text-align: right;">Progreso: <span>{{curso.pivot.progress*100}}%</span></h5>
                            </ion-list-header>
                            <ion-progress-bar [value]="curso.pivot.progress" color="primary"></ion-progress-bar>
                          </div>
                        </ion-item>
                      </div>
                    </div>
                  </ion-list>
                </mat-tab>
                <mat-tab>
                  <ng-template mat-tab-label>
                    <ion-card-title class="title-css2" style="text-align: center;">COMPLETADO</ion-card-title>
                  </ng-template>
                  <br>
                  <ion-list class="itemCssF list-md">
                    <div *ngFor="let curso of cursos">
                      <div *ngIf="curso.pivot.progress == 1">
                        <ion-item class="ion-item-css">
                          <ion-avatar slot="start">
                            <img src="https://venki.inkdigital.co/{{curso.photo}}" (click)="verCurso(curso)">
                          </ion-avatar>
                          <ion-label class="Subtitle-css" (click)="verCurso(curso)">
                            <h4>{{curso.name}}</h4>
                          </ion-label>
                          <div>
                            <ion-list-header>
                              <h5 style="text-align: right;">Progreso: <span>{{curso.pivot.progress*100}}%</span></h5>
                            </ion-list-header>
                            <ion-progress-bar [value]="curso.pivot.progress" color="primary"></ion-progress-bar>
                          </div>
                        </ion-item>
                      </div>
                    </div>
                  </ion-list>
                </mat-tab>
              </mat-tab-group>
            </div>
          </div>
          <br>
        </mat-tab>


        <mat-tab>
          <ng-template mat-tab-label>
            <ion-icon name="settings" class="larger"></ion-icon>
          </ng-template>
          <br>
          <ion-grid>
            <ion-list no-lines>
              <ion-item lines="none">
                <ion-label>
                  <ion-button [disabled]="usertk.premium  === 0" class="button-css-options" fill="clear" expand="block"
                    (click)="miCalendario()">
                    <ion-icon name="calendar-outline"></ion-icon>&nbsp;
                    Calendario
                  </ion-button>
                </ion-label>
              </ion-item>
              <ion-item lines="none">
                <ion-label>
                  <ion-button class="button-css-options" fill="clear" expand="block" (click)="miTimeLine()">
                    <ion-icon name="calendar-outline"></ion-icon>&nbsp;
                    TimeLine
                  </ion-button>
                </ion-label>
              </ion-item>
              <ion-item lines="none">
                <ion-label>
                  <ion-button [disabled]="usertk.surveyed  !== 1" class="button-css-options" fill="clear" expand="block"
                    (click)="misEstadisticas()">
                    <ion-icon name="stats-chart-outline"></ion-icon>&nbsp;
                    Metricas
                  </ion-button>
                </ion-label>
              </ion-item>
              <ion-item lines="none">
                <ion-label>
                  <ion-button class="button-css-options" fill="clear" expand="block" (click)="MisObjetivos(usertk.id)">
                    <ion-icon name="stats-chart-outline"></ion-icon>&nbsp;
                    Mis Objetivos
                  </ion-button>
                </ion-label>
              </ion-item>
              <ion-item lines="none">
                <ion-label>
                  <ion-button [disabled]="usertk.surveyed  === 1" class="button-css-options" fill="clear" expand="block"
                    (click)="diagnosticoRedirect(usertk.profile.id,  usertk.id)">
                    <ion-icon name="book"></ion-icon>&nbsp;
                    Diagnostico
                  </ion-button>
                </ion-label>
              </ion-item>
              <ion-item lines="none">
                <ion-label>
                  <ion-button [disabled]="usertk.surveyed  !== 1" class="button-css-options" fill="clear" expand="block"
                    (click)="recomedacionesRedirect(usertk.id)">
                    <ion-icon name="book"></ion-icon>&nbsp;
                    Recomendaciones
                  </ion-button>
                </ion-label>
              </ion-item>
              <ion-item lines="none">
                <ion-label>

                </ion-label>
              </ion-item>
            </ion-list>

          </ion-grid>
          <ion-button class="button-css-options" shape="round" (click)="opcionesRedirect()">
            Cerrar Sesión
            <ion-icon name="key"> </ion-icon>
          </ion-button>
          <br>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>

  <div *ngIf="usertk !== null">
    <ion-card *ngIf="usertk.email == 'usuarioN@hotmail.com'">
      <ion-card-content>
        <ion-item>
          <ion-avatar slot="start">
            <img
              src="https://happytravel.viajes/wp-content/uploads/2020/04/146-1468479_my-profile-icon-blank-profile-picture-circle-hd.png"
              (click)="abrirDialogo(usertk)">
          </ion-avatar>
          <ion-label>{{usertk.name}}</ion-label>
        </ion-item>
      </ion-card-content>
    </ion-card>
  </div>
  <br>



</ion-content>